(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[416],{1066:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(5155),a=s(3568);function l(){a.Ay.success("Для большей информации свяжитесь с менеджером")}s(2115);let i=()=>(0,r.jsxs)("div",{className:"relative overflow-hidden bg-[#cea5a1] py-2 sm:py-3 marquee",children:[(0,r.jsx)("div",{className:"absolute left-0 top-0 h-full w-6 sm:w-10 bg-gradient-to-r from-[#cea5a1] to-transparent z-10 pointer-events-none"}),(0,r.jsx)("div",{className:"absolute right-0 top-0 h-full w-6 sm:w-10 bg-gradient-to-l from-[#cea5a1] to-transparent z-10 pointer-events-none"}),(0,r.jsx)("div",{className:"marquee-track",children:[...Array(10)].map((e,t)=>(0,r.jsxs)("div",{className:"flex gap-x-4 px-2",children:[(0,r.jsxs)("button",{href:"/app/deals/page.js",className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm text-black whitespace-nowrap transition",onClick:l,children:[(0,r.jsx)("span",{className:"text-sm sm:text-base",children:"\uD83C\uDF53"}),(0,r.jsx)("p",{className:"hover:underline",children:"Бесплатная доставка от 5000₽"})]}),(0,r.jsxs)("button",{href:"/app/deals/page.js",className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm text-black whitespace-nowrap transition",onClick:l,children:[(0,r.jsx)("span",{className:"text-sm sm:text-base",children:"\uD83C\uDF53"}),(0,r.jsx)("p",{className:"hover:underline",children:"Открытка в подарок!"})]}),(0,r.jsxs)("button",{href:"/app/deals/page.js",className:"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm text-black whitespace-nowrap transition",onClick:l,children:[(0,r.jsx)("span",{className:"text-sm sm:text-base",children:"\uD83C\uDF53"}),(0,r.jsx)("p",{className:"hover:underline",children:"Промокод 3% на первый заказ"})]})]},t))})]})},8071:()=>{},8309:(e,t,s)=>{"use strict";s.d(t,{default:()=>u});var r=s(5155),a=s(2115),l=s(8800),i=s(6766);s(9408),s(2252),s(8071);var n=s(2325),c=s(7677),o=s(9516);let d=e=>{let{images:t,productName:s}=e;return Array.isArray(t)&&0!==t.length?(0,r.jsx)("div",{children:(0,r.jsxs)(c.RC,{modules:[n.Vx],slidesPerView:1,navigation:{nextEl:".swiper-button-left",prevEl:".swiper-button-right"},className:"relative",centeredSlides:!0,children:[t.map((e,t)=>(0,r.jsx)(c.qr,{children:(0,r.jsx)(i.default,{src:e,alt:"bouquet",width:300,height:400,className:"object-cover rounded-md cursor-pointer m-auto w-100 h-130",loading:"lazy"})},t)),(0,r.jsx)(i.default,{src:o.A,alt:"arrow",width:30,className:"swiper-button-left"}),(0,r.jsx)(i.default,{src:o.A,alt:"arrow",height:30,className:"swiper-button-right"})]})}):(0,r.jsx)("p",{children:"Нет изображений"})},u=e=>{var t;let{id:s,title:n,category:c}=e,{addToCart:o}=(0,l._)(),u="string"==typeof c?[c]:c,{products:m,loading:p,error:x}=function(){let[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)(!0),[l,i]=(0,a.useState)(null);return(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/products");if(!e.ok)throw Error("Ошибка загрузки данных с сервера");let s=await e.json();console.log("Полученные данные продуктов:",s),Array.isArray(s)&&s.forEach(e=>{e.id&&e.name&&e.price&&Array.isArray(e.sliders)||console.warn("Неверные данные для продукта:",e)}),t(s)}catch(e){console.error("Ошибка:",e),i("Не удалось загрузить данные")}finally{r(!1)}})()},[]),{products:e,loading:s,error:l}}(u),h=m.filter(e=>"string"==typeof e.category?u.includes(e.category):!!Array.isArray(e.category)&&e.category.some(e=>u.includes(e))),[g,f]=(0,a.useState)(null),[y,b]=(0,a.useState)(""),[N,j]=(0,a.useState)(0),[v,w]=(0,a.useState)(!1),[C,A]=(0,a.useState)(""),E=(0,a.useCallback)(e=>{var t,s;f(e);let r=null===(t=e.options.size)||void 0===t?void 0:t[0],a=null===(s=e.price)||void 0===s?void 0:s[0];b(r||""),j(a||0),w(!0),A(e.image)},[]),R=(0,a.useCallback)(()=>{f(null),w(!1)},[]);return((0,a.useEffect)(()=>(v?(document.body.style.overflow="hidden",document.body.style.paddingRight="".concat(window.innerWidth-document.documentElement.clientWidth,"px")):(document.body.style.overflow="",document.body.style.paddingRight=""),()=>{document.body.style.overflow="",document.body.style.paddingRight=""}),[v]),p)?(0,r.jsx)("div",{className:"loader",children:"Загрузка..."}):x?(0,r.jsxs)("p",{className:"text-red-500",children:["Ошибка: ",x]}):(0,r.jsxs)("section",{id:s,className:"my-8",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-center mb-4",children:n}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 w-11/12 ml-auto mr-auto",children:p?(0,r.jsx)("div",{className:"loader",children:"Загрузка..."}):x?(0,r.jsxs)("p",{className:"text-red-500",children:["Ошибка: ",x]}):0===h.length?(0,r.jsx)("p",{className:"text-center",children:"Нет товаров в этой категории."}):h.map(e=>{if(!e.name||!e.price||!e.image)return console.error("Ошибка: отсутствуют обязательные данные для продукта с id ".concat(e.id)),null;let t=e.images&&Array.isArray(e.images)&&e.images.length>1;return(0,r.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-md flex flex-col justify-between",children:[(0,r.jsx)("div",{className:"relative w-full 2x1:h-100",children:t?(0,r.jsx)(d,{images:e.images,productName:e.name}):(0,r.jsx)(i.default,{src:e.image,alt:e.name,className:"object-cover rounded-md cursor-pointer w-100 h-130",width:300,height:400,onClick:()=>E(e),loading:"lazy"})}),(0,r.jsx)("h3",{className:"mt-2 text-lg font-semibold",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-500 line-clamp-2",children:e.description||"Без описания"}),(0,r.jsxs)("p",{className:"text-red-500 font-bold",children:[e.price[0]," ₽"]}),(0,r.jsx)("button",{className:"mt-2 bg-[#F1ADAE] text-white px-4 py-2 rounded-md shadow-md hover:bg-[#ec9898] transition",onClick:()=>E(e),children:"Заказать"})]},e.id)})}),v&&g&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-opacity-50 backdrop-blur-sm animate-fade-in overflow-y-auto py-8",onClick:R,children:(0,r.jsxs)("div",{className:"bg-white w-full max-w-lg p-6 rounded-2xl shadow-2xl transform transition-all scale-100 animate-fade-in max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("button",{className:"absolute top-4 right-4 text-xl font-bold text-gray-500",onClick:R}),(0,r.jsx)("h3",{className:"text-xl font-bold text-center mb-2",children:g.name}),(0,r.jsx)("p",{className:"text-gray-600 text-center",children:g.description||"Без описания"}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(d,{images:g.images,productName:g.productName})}),(0,r.jsx)("div",{className:"flex",children:null===(t=g.options.size)||void 0===t?void 0:t.map((e,t)=>(0,r.jsx)("div",{children:(0,r.jsx)("button",{onClick:()=>{b(e),j(g.price[t])},className:"".concat(y===e?"bg-gray-300":""," rounded-2xl p-2 hover:bg-gray-100 transition-colors"),children:e})},t))}),(0,r.jsxs)("p",{className:"text-lg font-bold text-red-600 mb-4",children:["Итого: ",N," ₽"]}),(0,r.jsx)("button",{onClick:()=>{if(!y){alert("Выберите вариант!");return}o({...g,selectedOption:y,price:N}),R()},className:"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600",children:"Добавить в корзину"})]})})]})}},8800:(e,t,s)=>{"use strict";s.d(t,{CartProvider:()=>c,_:()=>o});var r=s(5155),a=s(2115),l=s(3568);let i=(0,a.createContext)(),n=(e,t)=>{switch(t.type){case"INIT_CART":return t.payload||[];case"ADD_TO_CART":{let s=e.find(e=>e.id===t.product.id&&e.selectedOption===t.product.selectedOption);if(s){if(s.quantity>=10)return e;return e.map(e=>e.id===t.product.id&&e.selectedOption===t.product.selectedOption?{...e,quantity:Math.min(e.quantity+1,10)}:e)}return[...e,{...t.product,quantity:1}]}case"REMOVE_FROM_CART":return e.filter(e=>e.id!==t.id||e.selectedOption!==t.option);case"INCREMENT_QUANTITY":return e.map(e=>e.id===t.id&&e.selectedOption===t.option?e.quantity>=10?e:{...e,quantity:Math.min(e.quantity+1,10)}:e);case"DECREMENT_QUANTITY":return e.map(e=>e.id===t.id&&e.selectedOption===t.option?{...e,quantity:Math.max(1,e.quantity-1)}:e);case"CLEAR_CART":return[];default:return e}},c=e=>{let{children:t}=e,[s,c]=(0,a.useReducer)(n,[]),o=(0,a.useRef)(!1),d=(0,a.useRef)(null),u=(0,a.useRef)([]);(0,a.useEffect)(()=>{let e=localStorage.getItem("cart");if(e)try{let t=JSON.parse(e);c({type:"INIT_CART",payload:t}),u.current=t}catch(e){localStorage.removeItem("cart")}},[]),(0,a.useEffect)(()=>{JSON.stringify(u.current)!==JSON.stringify(s)&&(s.length>0?localStorage.setItem("cart",JSON.stringify(s)):localStorage.removeItem("cart"),u.current=s)},[s]),(0,a.useEffect)(()=>()=>{d.current&&clearTimeout(d.current)},[]);let m=(0,a.useCallback)(e=>{let t=s.find(t=>t.id===e.id&&t.selectedOption===e.selectedOption);if((null==t?void 0:t.quantity)>=10){o.current||(l.oR.error("Нельзя добавить больше 10 штук этого букета в корзину"),o.current=!0,d.current=setTimeout(()=>{o.current=!1},3e3));return}c({type:"ADD_TO_CART",product:e})},[s]),p=(0,a.useCallback)((e,t)=>{let r=s.find(s=>s.id===e&&s.selectedOption===t);if((null==r?void 0:r.quantity)>=10){o.current||(l.oR.error("Максимум 10 штук одного букета"),o.current=!0,d.current=setTimeout(()=>{o.current=!1},3e3));return}c({type:"INCREMENT_QUANTITY",id:e,option:t})},[s]),x=(0,a.useCallback)((e,t)=>{c({type:"REMOVE_FROM_CART",id:e,option:t}),o.current=!1},[]),h=(0,a.useCallback)((e,t)=>{c({type:"DECREMENT_QUANTITY",id:e,option:t}),o.current=!1},[]),g=(0,a.useCallback)(()=>{c({type:"CLEAR_CART"}),o.current=!1},[]);return(0,r.jsx)(i.Provider,{value:{cart:s,addToCart:m,removeFromCart:x,increaseQuantity:p,decreaseQuantity:h,clearCart:g},children:t})},o=()=>(0,a.useContext)(i)},9516:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r={src:"/_next/static/media/arrow.2bc10128.svg",height:683,width:683,blurWidth:0,blurHeight:0}}}]);